# MIDIToKeyboard

## 概要

MIDI キーボード入力を、PC のキーボード入力に変換する Windows 向けツールです。

MIDI 信号の Note On/Off 信号をキーボードの KeyDown/Up イベントに変換する Windows コンソールアプリです。MIDI キーボードやパッドを使って、キーボード入力対応の音楽ゲームをプレイしたい人向けのツールです。

## 動作環境

- OS: Windows 11
- ランタイム: .NET Framework 4.7.2 (`net472`)

※ Windows 10 でも動作する可能性は高いですが、本プロジェクトでは Windows 11 上でのみ検証しています。

※ MIDI 入力として認識されるデバイスが必要です（USB-MIDI 対応キーボードなど）。

## ビルド方法

事前に依存ライブラリ（「依存ライブラリ」参照）を導入の上、ビルドしてください。Visual Studio であれば「NuGet パッケージの管理」から追加します。

※このプロジェクトは、Microsoft Visual Studio Community 2022 (64 ビット) を使用して開発しています。

## 利用方法

1. MIDI Note 番号とキーのマッピングを mappings.json に設定します。
    - 設定内容は「mappings.json の設定」を参照してください。
2. MIDI キーボードまたはパッド等の機器を PC に接続します。
3. 本アプリを起動します。
    - PC に接続された MIDI 機器を選択します。
    - キーボードイベントの送信方法を選択します。
    - マッピングセットを選択します。
    - Note 信号 To キーボードイベントの変換を開始します。
4. 任意のゲームでキー入力として利用できます。
5. コンソール画面で何かキーを押下すると終了します。

※管理者権限は不要です。

※送信方法は **仮想キーコード** または **スキャンコード** です。後者は英語配列のキーボードに対応しています。

※ノート名（C4 など）とノート番号の対応は、`NoteNumberList.md` を参照してください。

## mappings.json の設定

ノート番号とキーの組み合わせのパターンを sets に追加します（複数可）。name にセットの名前、mappings にノート番号とキーの組み合わせを記述します。

設定例
```json
{
  "sets": [
    {
      "name": "Default",
      "mappings": {
        "52": "v",
        "53": "s",
        "55": "d",
        "57": "f",
        "59": "g",
        "65": "h",
        "67": "j",
        "69": "k",
        "71": "l",
        "72": "n"
       }
    }
  ]
}
```

※ 1つのノート番号には、1つのキーのみ割り当てられます。

※実行ファイルと同じフォルダに mappings.json を置いてください。

## 動作確認タイトル

- DJMAX RESPECT V (XBOX/Steam)
- MUSYNX (XBOX/Steam)
- EZ2ON (Steam)

※ XBOX は、Xbox Play Anywhere による PC 版です。

※ DJMAX RESPECT V は、スキャンコードのみ使用できます。

※他のゲームでも動作する可能性があります。

## 課題

※このプログラムは、現在プロトタイプ段階です。将来的に構造を見直し、タスクトレイ対応を予定しています。

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。
詳細は `LICENSE` を参照してください。

## 依存ライブラリ

- [`Melanchall.DryWetMidi`](https://github.com/melanchall/drywetmidi) - MIT License

※依存ライブラリのライセンスはそれぞれの作者に帰属します。